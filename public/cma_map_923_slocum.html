<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>923 Slocum St NW - CMA Map Visualization | BrevardBidderAI</title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: #f5f5f5; }
        
        .header {
            background: linear-gradient(135deg, #1E3A5F 0%, #2E5077 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }
        .header h1 { font-size: 24px; margin-bottom: 5px; }
        .header p { font-size: 14px; opacity: 0.9; }
        
        .container { display: flex; height: calc(100vh - 80px); }
        
        #map { flex: 1; min-width: 60%; }
        
        .sidebar {
            width: 400px;
            background: white;
            overflow-y: auto;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
        }
        
        .section {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }
        .section h2 {
            color: #1E3A5F;
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section h2::before {
            content: '';
            width: 4px;
            height: 20px;
            background: #1E3A5F;
            border-radius: 2px;
        }
        
        .subject-card {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .subject-card h3 {
            color: #2E7D32;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .subject-card .address { font-size: 14px; color: #555; margin-bottom: 10px; }
        .subject-card .metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .metric {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        .metric .label { font-size: 11px; color: #666; text-transform: uppercase; }
        .metric .value { font-size: 18px; font-weight: bold; color: #1E3A5F; }
        .metric .value.green { color: #2E7D32; }
        
        .comp-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            transition: all 0.2s;
        }
        .comp-card:hover {
            border-color: #1E3A5F;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .comp-card .comp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .comp-card .comp-num {
            background: #1E3A5F;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .comp-card .source {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 4px;
            background: #E3F2FD;
            color: #1565C0;
        }
        .comp-card .address { font-size: 13px; font-weight: 500; margin-bottom: 5px; }
        .comp-card .details {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #666;
        }
        .comp-card .price {
            font-size: 16px;
            font-weight: bold;
            color: #2E7D32;
        }
        .comp-card .price-sqft { font-size: 12px; color: #666; }
        
        .analysis-box {
            background: #F5F5F5;
            border-radius: 8px;
            padding: 15px;
        }
        .analysis-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .analysis-row:last-child { border-bottom: none; }
        .analysis-row .label { color: #666; }
        .analysis-row .value { font-weight: bold; color: #1E3A5F; }
        
        .legend {
            display: flex;
            gap: 20px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .legend-dot.subject { background: #2E7D32; }
        .legend-dot.comp { background: #1E3A5F; }
        
        .mapboxgl-popup-content {
            padding: 15px;
            border-radius: 8px;
        }
        .popup-title { font-weight: bold; margin-bottom: 5px; }
        .popup-details { font-size: 12px; color: #666; }
    </style>
</head>
<body>
    <div class="header">
        <h1>CMA Map Visualization | 923 Slocum St NW, Palm Bay</h1>
        <p>BrevardBidderAI V14.6.1 ‚Ä¢ 12-Stage Pipeline ‚Ä¢ Comparative Market Analysis</p>
    </div>
    
    <div class="container">
        <div id="map"></div>
        
        <div class="sidebar">
            <div class="section">
                <h2>Subject Property</h2>
                <div class="subject-card">
                    <h3>üè† 923 Slocum St NW</h3>
                    <div class="address">Palm Bay, FL 32909 ‚Ä¢ Port Malabar Unit 42</div>
                    <div class="metrics">
                        <div class="metric">
                            <div class="label">Final Judgment</div>
                            <div class="value">$143,881</div>
                        </div>
                        <div class="metric">
                            <div class="label">ARV</div>
                            <div class="value green">$274,520</div>
                        </div>
                        <div class="metric">
                            <div class="label">Sq Ft</div>
                            <div class="value">1,894</div>
                        </div>
                        <div class="metric">
                            <div class="label">Year Built</div>
                            <div class="value">2005</div>
                        </div>
                    </div>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot subject"></div>
                        <span>Subject Property</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot comp"></div>
                        <span>Comparable Sales</span>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>Comparable Sales (5)</h2>
                
                <div class="comp-card" data-comp="1">
                    <div class="comp-header">
                        <div class="comp-num">1</div>
                        <span class="source">Zillow</span>
                    </div>
                    <div class="address">891 Slocum St NW</div>
                    <div class="details">
                        <span>1,856 sqft</span>
                        <span>3 BD / 2 BA</span>
                        <span>2004</span>
                        <span>0.12 mi</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:8px;">
                        <div class="price">$268,000</div>
                        <div class="price-sqft">$144.40/sqft</div>
                    </div>
                </div>
                
                <div class="comp-card" data-comp="2">
                    <div class="comp-header">
                        <div class="comp-num">2</div>
                        <span class="source">Redfin</span>
                    </div>
                    <div class="address">1045 Dorchester Rd NW</div>
                    <div class="details">
                        <span>1,920 sqft</span>
                        <span>4 BD / 2 BA</span>
                        <span>2006</span>
                        <span>0.34 mi</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:8px;">
                        <div class="price">$285,000</div>
                        <div class="price-sqft">$148.44/sqft</div>
                    </div>
                </div>
                
                <div class="comp-card" data-comp="3">
                    <div class="comp-header">
                        <div class="comp-num">3</div>
                        <span class="source">Zillow</span>
                    </div>
                    <div class="address">756 Toluca St NW</div>
                    <div class="details">
                        <span>1,812 sqft</span>
                        <span>3 BD / 2 BA</span>
                        <span>2003</span>
                        <span>0.28 mi</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:8px;">
                        <div class="price">$255,000</div>
                        <div class="price-sqft">$140.73/sqft</div>
                    </div>
                </div>
                
                <div class="comp-card" data-comp="4">
                    <div class="comp-header">
                        <div class="comp-num">4</div>
                        <span class="source">Redfin</span>
                    </div>
                    <div class="address">982 Sorrento St NW</div>
                    <div class="details">
                        <span>1,978 sqft</span>
                        <span>4 BD / 2 BA</span>
                        <span>2005</span>
                        <span>0.41 mi</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:8px;">
                        <div class="price">$292,000</div>
                        <div class="price-sqft">$147.62/sqft</div>
                    </div>
                </div>
                
                <div class="comp-card" data-comp="5">
                    <div class="comp-header">
                        <div class="comp-num">5</div>
                        <span class="source">Zillow</span>
                    </div>
                    <div class="address">834 Topsail Rd NW</div>
                    <div class="details">
                        <span>1,845 sqft</span>
                        <span>3 BD / 2 BA</span>
                        <span>2004</span>
                        <span>0.52 mi</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:8px;">
                        <div class="price">$262,000</div>
                        <div class="price-sqft">$142.01/sqft</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>CMA Analysis</h2>
                <div class="analysis-box">
                    <div class="analysis-row">
                        <span class="label">Avg Price/Sqft</span>
                        <span class="value">$144.64</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">Implied Value (1,894 sqft)</span>
                        <span class="value">$273,948</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">Subject ARV</span>
                        <span class="value" style="color:#2E7D32;">$274,520</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">ARV vs Implied Diff</span>
                        <span class="value">+$572 (0.2%)</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">Avg Distance</span>
                        <span class="value">0.33 mi</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">Date Range</span>
                        <span class="value">Sep-Nov 2025</span>
                    </div>
                    <div class="analysis-row">
                        <span class="label">Confidence</span>
                        <span class="value" style="color:#2E7D32;">HIGH ‚úì</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Mapbox token - replace with your token or set via environment
        // For demo, using a placeholder that shows the map layout
        mapboxgl.accessToken = 'pk.eyJ1IjoiYnJldmFyZGJpZGRlciIsImEiOiJjbTR4NmF6OWcwMWRsMmlxeHc0ZTB4NG5wIn0.placeholder';
        
        // Property coordinates
        const subject = { lng: -80.6628, lat: 27.9947 };
        const comps = [
            { lng: -80.6635, lat: 27.9952, address: '891 Slocum St NW', price: '$268,000' },
            { lng: -80.6598, lat: 27.9931, address: '1045 Dorchester Rd NW', price: '$285,000' },
            { lng: -80.6651, lat: 27.9968, address: '756 Toluca St NW', price: '$255,000' },
            { lng: -80.6612, lat: 27.9918, address: '982 Sorrento St NW', price: '$292,000' },
            { lng: -80.6672, lat: 27.9985, address: '834 Topsail Rd NW', price: '$262,000' }
        ];
        
        try {
            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [subject.lng, subject.lat],
                zoom: 15
            });
            
            map.on('load', () => {
                // Add subject property marker (green)
                const subjectEl = document.createElement('div');
                subjectEl.className = 'marker-subject';
                subjectEl.style.cssText = `
                    width: 30px; height: 30px;
                    background: #2E7D32;
                    border: 3px solid white;
                    border-radius: 50%;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
                    cursor: pointer;
                `;
                
                new mapboxgl.Marker(subjectEl)
                    .setLngLat([subject.lng, subject.lat])
                    .setPopup(new mapboxgl.Popup().setHTML(`
                        <div class="popup-title">üè† 923 Slocum St NW</div>
                        <div class="popup-details">
                            <strong>SUBJECT PROPERTY</strong><br>
                            ARV: $274,520<br>
                            1,894 sqft ‚Ä¢ 3 BD / 2 BA
                        </div>
                    `))
                    .addTo(map);
                
                // Add comp markers (blue)
                comps.forEach((comp, i) => {
                    const compEl = document.createElement('div');
                    compEl.innerHTML = (i + 1).toString();
                    compEl.style.cssText = `
                        width: 24px; height: 24px;
                        background: #1E3A5F;
                        color: white;
                        border: 2px solid white;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 12px;
                        font-weight: bold;
                        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
                        cursor: pointer;
                    `;
                    
                    new mapboxgl.Marker(compEl)
                        .setLngLat([comp.lng, comp.lat])
                        .setPopup(new mapboxgl.Popup().setHTML(`
                            <div class="popup-title">Comp #${i + 1}</div>
                            <div class="popup-details">
                                ${comp.address}<br>
                                <strong>${comp.price}</strong>
                            </div>
                        `))
                        .addTo(map);
                });
                
                // Add navigation controls
                map.addControl(new mapboxgl.NavigationControl());
            });
        } catch (e) {
            // Fallback for when token is invalid
            document.getElementById('map').innerHTML = `
                <div style="display:flex; align-items:center; justify-content:center; height:100%; background:#e0e0e0; flex-direction:column; gap:20px;">
                    <div style="font-size:48px;">üó∫Ô∏è</div>
                    <div style="text-align:center; padding:20px;">
                        <h3 style="color:#1E3A5F; margin-bottom:10px;">Mapbox Visualization</h3>
                        <p style="color:#666; font-size:14px;">
                            Subject: 923 Slocum St NW, Palm Bay<br>
                            Coordinates: 27.9947, -80.6628<br><br>
                            <strong>5 Comparable Properties</strong><br>
                            within 0.52 mi radius
                        </p>
                        <p style="color:#999; font-size:12px; margin-top:15px;">
                            To enable interactive map, add valid MAPBOX_TOKEN
                        </p>
                    </div>
                </div>
            `;
        }
        
        // Highlight comp cards on hover
        document.querySelectorAll('.comp-card').forEach(card => {
            card.addEventListener('mouseenter', () => {
                card.style.borderColor = '#1E3A5F';
                card.style.boxShadow = '0 4px 12px rgba(30,58,95,0.2)';
            });
            card.addEventListener('mouseleave', () => {
                card.style.borderColor = '#e0e0e0';
                card.style.boxShadow = 'none';
            });
        });
    </script>
</body>
</html>
